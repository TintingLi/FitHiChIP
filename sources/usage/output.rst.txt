Details of FitHiChIP outputs
===============================

Summary HTML file
--------------------

Suppose **OutDir** denotes the specified output directory in the configuration file. Then, successful execution of FitHiChIP pipeline generates an HTML file *Summary_results_FitHiChIP.html* within this output directory. This file lists all output files generated from the FitHiChIP pipeline, according to the given input parameters.

Details of output files
------------------------

Here we describe all the files and folders existing within the specified output directory **OutDir**.

	1. **Parameters.txt**: a file listing the parameters used for current execution.

	2. **TimingProfile.txt**: If the parameter (G.3) is 1, this file lists the time taken for individual steps.

	3. **HiCPro_Matrix_BinSize"BINSIZE"**: If the parameters (A.2) and (A.3) are empty, this folder contains the interaction matrix files generated from the input valid pairs file. The interaction matrix files are *MatrixHiCPro_abs.bed* and *MatrixHiCPro.matrix*.

		- **\*.interactions.initial.bed**: CIS interactions with respect to this contact matrix file (interacting regions, and their contact counts) are also dumped separately in this file.

		- **L_"l"_U"u"**: folder name according to the distance thresholds "l" and "u" specified in the parameters (C.3) and (C.4).

			- **\*.cis.interactions.DistThr.bed**: File within the above mentioned directory contains the CIS interactions filtered within the specified distance thresholds l and u.

	4. **NormFeatures**: Folder containing various statistical features computed for individual genomic intervals / bins (with respect to the specified bin size). 

		- User may look at the file **\*.AllBin_CompleteFeat.bed** specifically. The file is of the following format:

			- Columns 1 to 3: chromosome interval (according to the specified bin size).
 
 			- Column 4: Coverage of this interval (number of reads mapped onto it)
 
 			- Column 5: denotes whether this interval belongs to a peak segment (1) or non-peak segment (0). Here, the peak information is with respect to the parameter (A.4) of the configuration file.

 			- Column 6: Bias value of this interval. Computed either by coverage specific bias correction, or the ICE specific bias normalization, according to the value of the parameter (E.2).
 
 			- Columns 7 and 8 denote the mappability and GC contents, respectively, for the current interval. 
 
 				- *These values are zero if no mappability, restriction fragment and reference genome fasta sequence are provided*.

	5. The folders **FitHiChIP_"INTTYPE"_b"BINSIZE"_L"l"_U"u"** contain the results for different types of interactions, subject to the specified bin size, and the distance thresholds specified.

		- INTTYPE: interaction type: Have one of the following values:

 			- ALL2ALL (when the parameter (C.1) = 4)

 			- Peak2Peak (when the parameter (C.1) = 1)

 			- Peak2NonPeak (when the parameter (C.1) = 2)

 			- Peak2ALL (when the parameter (C.1) = 3)

		- Within this folder, a directory structure of the following naming pattern is created:

 			**P2PBckgr_[UseP2PBackgrnd]/[BiasType]**

 		Where: 

 			- [UseP2PBackgrnd]: Value of the parameter (D.2)

 			- [BiasType]: String of either "Coverage_Bias" or "ICE_Bias", according to the value of parameter (E.2).

		- Within this generic directory structure, following files and folders are created:

 			- **Interactions.bed**: All contacts among the selected pairs of segments (depending upon the value of INTTYPE). 

 			- **Interactions.sortedGenDist.bed**: Above contacts are sorted by increasing genomic distance. Used as an input to the custom FitHiC implementation.

 			- **FitHiC**: If the option (E.1) = 0, this folder contains the significant interactions generated by Naive FitHiC method (without any bias correction technique).

 			- **FitHiC_BiasCorr**: this folder is created when (E.1) = 1.

 			Directory structure within the folders **FitHiC** and **FitHiC_BiasCorr** are similar. Following files and folders reside within this directory:

 				- **Bin_Info.log**: File listing the bins employed in FitHiChIP (equal occupancy bins)
 				
 				- configuration.txt: list of configuration parameters for FitHiChIP
 				
 				- ***PREFIX*.interactions_FitHiC.bed**: Lists all interactions along with their probabilities, p and q values, computed using the FitHiChIP method.

 				- ***PREFIX*.interactions_FitHiC_Q"$qval".bed**: Lists the significant interactions according to the q-value ($qval) significance threshold specified as an input argument. For example, if q value threshold is 0.01, the file name becomes ***PREFIX*.interactions_FitHiC_Q0.01.bed**.
 			
 				.. note:: 

 					For a custom FDR threshold (say 0.05), user may use the following awk script to filter the file (C) based on its last column.
 			
 						awk '$NF<0.05' PREFIX.interactions_FitHiC.bed > FitHiC_out_Q0.05.bed

 				- ***PREFIX*.interactions_FitHiC_Q"$qval"_WashU.bed.gz**: Significant interactions are converted to WashU epigenome browser compatible format. There is also a tabix compressed file alongwith. User can upload this file in the WashU epigenome browser.
 			
 				
 				- ***PREFIX*.interactions_FitHiC_Q"$qval"_Dist_CC.pdf**: Plots the contact count vs genomic distance, corresponding to the significant loops.
 			
 				- **Merge_Nearby_Interactions**: Directory containing the output of merge filtering operation, provided the parameter (F.1) is set as 1.
 			
 					- ***PREFIX*.interactions_FitHiC_Q"$qval"_MergeNearContacts.bed**: output significant loop file after merge filtering operation.
 				
 					- ***PREFIX*.interactions_FitHiC_Q"$qval"_MergeNearContacts_WashU.bed.gz**: WashU epigenome browser compatible loops.
 				
 					- ***PREFIX*.interactions_FitHiC_Q"$qval"_MergeNearContacts_Dist_CC.pdf**: Plot between contact count and interaction distance, corresponding to the significant and merged loops.





















